<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">
    <title>Split Flop Timer - Відлік днів</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="logo">
                <i class="fas fa-clock"></i>
                <h1>Split Flop Timer - Відлік днів</h1>
            </div>
            <div class="device-info">
                <span class="ip-address"><i class="fas fa-wifi"></i> <span id="ip-address">timer.local</span></span>
                <span class="status" id="connection-status"><i class="fas fa-circle"></i> Підключено</span>
            </div>
        </header>

        <div class="system-status">
            <div class="status-grid">
                <div class="status-item">
                    <span class="status-label">Поточний час ESP32:</span>
                    <span class="status-value" id="current-time">--:--:--</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Залишилось днів:</span>
                    <span class="status-value" id="time-remaining">0 днів</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Статус двигунів:</span>
                    <span class="status-value" id="motor-status">Не калібровані</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Статус таймера:</span>
                    <span class="status-value" id="timer-status">Активний</span>
                </div>
            </div>
        </div>

        <!-- ========== ОСНОВНИЙ КОНТЕНТ – СІТКА ========== -->
        <main class="main-content">
            <!-- Ліва колонка (десктоп) – 2fr, містить setup + bothrow -->
            <div class="grid-area-setup">
                <div class="panel-section">
                    <h2><i class="fas fa-calendar-plus"></i> Встановлення відліку</h2>
                    <div class="time-setup">
                        <div class="time-group">
                            <h3><i class="fas fa-play-circle"></i> Початкова точка</h3>
                            <div class="datetime-inputs">
                                <div class="input-group calendar-group">
                                    <label><i class="fas fa-calendar-alt"></i> Дата початку:</label>
                                    <div class="calendar-wrapper">
                                        <input type="date" id="start-date" value="2026-01-01" class="calendar-input">
                                    </div>
                                </div>
                                <div class="input-group time-group">
                                    <label><i class="fas fa-clock"></i> Час початку:</label>
                                    <div class="time-wrapper">
                                        <input type="time" id="start-time" value="12:00:00" step="1" class="time-input">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Права колонка (десктоп) – 1fr, містить enddate + imit -->
            <div class="grid-area-enddate">
                <div class="panel-section">
                    <h2><i class="fas fa-calendar-check"></i> Дата завершення</h2>
                    <div class="end-date-display">
                        <div class="date-display-wrapper">
                            <div class="date-icon">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <div class="date-content">
                                <div class="date-label">Закінчення відліку:</div>
                                <div class="date-value" id="end-date-display">Обчислюється...</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Контейнер для двох блоків поруч (Тривалість відліку + Синхронізація) -->
            <div class="grid-area-bothrow">
                <div class="two-panels-row">
                    <!-- Тривалість відліку (колишнє Тестування сегментів) -->
                    <div class="panel-section">
                        <h2><i class="fas fa-hourglass-half"></i> Тривалість відліку</h2>
                        <div class="test-display">
                            <div class="test-labels">
                                <span>Тис.</span>
                                <span>Сот.</span>
                                <span>Дес.</span>
                                <span>Од.</span>
                            </div>
                            <div class="test-digits" id="test-digits">
                                <div class="test-digit" data-segment="0">
                                    <div class="digit-number">0</div>
                                    <div class="digit-controls">
                                        <button class="digit-btn up"><i class="fas fa-chevron-up"></i></button>
                                        <button class="digit-btn down"><i class="fas fa-chevron-down"></i></button>
                                    </div>
                                </div>
                                <div class="test-digit" data-segment="1">
                                    <div class="digit-number">0</div>
                                    <div class="digit-controls">
                                        <button class="digit-btn up"><i class="fas fa-chevron-up"></i></button>
                                        <button class="digit-btn down"><i class="fas fa-chevron-down"></i></button>
                                    </div>
                                </div>
                                <div class="test-digit" data-segment="2">
                                    <div class="digit-number">0</div>
                                    <div class="digit-controls">
                                        <button class="digit-btn up"><i class="fas fa-chevron-up"></i></button>
                                        <button class="digit-btn down"><i class="fas fa-chevron-down"></i></button>
                                    </div>
                                </div>
                                <div class="test-digit" data-segment="3">
                                    <div class="digit-number">0</div>
                                    <div class="digit-controls">
                                        <button class="digit-btn up"><i class="fas fa-chevron-up"></i></button>
                                        <button class="digit-btn down"><i class="fas fa-chevron-down"></i></button>
                                    </div>
                                </div>
                            </div>
                            <div class="test-actions">
                                <button id="btn-apply-test" class="btn btn-secondary">
                                    <i class="fas fa-play"></i> Тестування цифр
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Синхронізація з NTP -->
                    <div class="panel-section">
                        <h2><i class="fas fa-sync-alt"></i> Синхронізація з NTP</h2>
                        <div class="sync-controls">
                            <div class="checkbox-label">
                                <input type="checkbox" id="auto-sync" checked>
                                <span class="checkmark"></span>
                                Автосинхронізація щодня
                            </div>
                            <div class="hour-selector-digits">
                                <div class="test-labels" style="margin-top: 10px;">
                                    <span>Год.1</span>
                                    <span>Год.2</span>
                                </div>
                                <div class="test-digits" id="hour-digits">
                                    <div class="test-digit" data-hour-digit="0">
                                        <div class="digit-number" id="hour-ten-digit">0</div>
                                        <div class="digit-controls">
                                            <button class="digit-btn up" id="hour-ten-up"><i class="fas fa-chevron-up"></i></button>
                                            <button class="digit-btn down" id="hour-ten-down"><i class="fas fa-chevron-down"></i></button>
                                        </div>
                                    </div>
                                    <div class="test-digit" data-hour-digit="1">
                                        <div class="digit-number" id="hour-one-digit">0</div>
                                        <div class="digit-controls">
                                            <button class="digit-btn up" id="hour-one-up"><i class="fas fa-chevron-up"></i></button>
                                            <button class="digit-btn down" id="hour-one-down"><i class="fas fa-chevron-down"></i></button>
                                        </div>
                                    </div>
                                </div>
                                <div style="text-align: center; margin-top: 10px; color: var(--text-secondary);">
                                    Година (00‑23)
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Імітація дисплея (права колонка) -->
            <div class="grid-area-imit">
                <div class="panel-section">
                    <h2><i class="fas fa-display"></i> Імітація дисплея</h2>
                    <div class="display-simulation">
                        <div class="display-labels">
                            <span>Тис.</span>
                            <span>Сот.</span>
                            <span>Дес.</span>
                            <span>Од.</span>
                        </div>
                        <div class="digit-display" id="digit-display">
                            <div class="digit-sim" data-segment="0">0</div>
                            <div class="digit-sim" data-segment="1">0</div>
                            <div class="digit-sim" data-segment="2">0</div>
                            <div class="digit-sim" data-segment="3">0</div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <div class="actions-bottom">
            <div class="action-buttons">
                <button id="btn-save" class="btn btn-primary">
                    <i class="fas fa-save"></i> Зберегти налаштування
                </button>
                <button id="btn-sync" class="btn btn-secondary">
                    <i class="fas fa-sync-alt"></i> Синхронізувати зараз
                </button>
                <button id="btn-calibrate" class="btn btn-warning">
                    <i class="fas fa-cogs"></i> Калібрувати двигуни
                </button>
                <button id="btn-stop" class="btn btn-danger">
                    <i class="fas fa-pause"></i> Зупинити/Запустити таймер
                </button>
            </div>
        </div>

        <footer class="footer">
            <p>Split Flop Timer Controller v4.5 | ESP32-S3 | 2 PCF8575 | 4 сегменти | Відлік днів</p>
            <p class="update-info">Останнє оновлення: <span id="last-update">--</span></p>
        </footer>
    </div>

    <div id="toast-container"></div>

    <script src="script.js"></script>
</body>
</html>